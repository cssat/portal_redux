-- create PROVIDER_DIM table

-- DROP TABLE portal_redux.PROVIDER_DIM;
CREATE TABLE portal_redux.PROVIDER_DIM (
	ID_PROVIDER_DIM int NOT NULL,
	ID_BSNS int NULL,
	ID_PRVD_ORG int NULL,
	ID_SSPS int NULL,
	ID_CALENDAR_DIM_CREATED int NULL,
	CD_MAIL_CITY int NULL,
	TX_MAIL_CITY varchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_MAIL_COUNTY varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_MAIL_STATE varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_MAIL_ZIP varchar(9) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_PHYS_CITY int NULL,
	TX_PHYS_CITY varchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_PHYS_COUNTY varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_PHYS_STATE varchar(2) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	TX_PHYS_ZIP varchar(9) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_PROVIDER_TYPE int NULL,
	TX_PROVIDER_TYPE varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_REGION int NULL,
	TX_REGION varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_SSPS_STATUS int NULL,
	TX_SSPS_STATUS varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_STAT char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CD_TRIBAL_AFLTN int NULL,
	TX_TRIBAL_AFLTN varchar(200) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_24_HOUR_CARE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_ABUSES_ANIMALS char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_ADA_NEEDS char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_ADJUDICATED_CRIMINAL char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_AFFILIATED_WITH_GANGS char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_AUTISTIC char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_BEFORE_AFTER_SCHOOL_ONLY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_DEVELOPMENTAL_DELAY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_DIABETIC char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_DIAGNOSED_MENTAL_HEALTH_CONDITION char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_DIAGNOSED_WITH_FETAL_ALCOHOL_SYNDROME char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_DRUG_AFFECTED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_EATING_DISORDER char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_ENCOPRETIC char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_ENURESIS char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_EVENING char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_FEMALE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_FIRE_SETTER char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_HEARING_IMPAIRED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_HIV_POSITIVE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_IV_DRUG_USER char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_IVE_TRIBAL_AGREEMENT char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_IVE_TRIBAL_AGRMT_IN_PLC char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_LEARNING_DISABILITIES char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_LIFE_SKILLS_TRAINING char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_MALE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_MASTURBATES_IN_PUBLIC char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_MEDICALLY_FRAGILE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_NAA_ACCREDITED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_NAEYC_ACCREDITED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_NAFCC_ACCREDITED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_OPEN char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_PARENT_AGENCY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_PHYSICALLY_AGGRESSIVE_YOUTH char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_PHYSICALLY_ASSAULTIVE_YOUTH_PAY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_PROPERTY_DESTRUCTION char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_PSYCHIATRIC_HOSPITALIZATION_HISTORY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_RELATIVE_CAREGIVER char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_REQUIRES_MEDICATION char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_REQUIRES_SPECIAL_DIET char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_RESIDENTIAL_TREATMENT_HISTORY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_RUNAWAY_HISTORY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SELF_ABUSIVE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SEXUALLY_ABUSED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SEXUALLY_ACTIVE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SEXUALLY_AGGRESSIVE_YOUTH char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SEXUALLY_AGGRESSIVE_YOUTH_SAY char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SEXUALLY_REACTIVE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SIBLING_GROUP char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SIGNIFICANT_ASTHMA_OR_ALLERGIES char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SPECIAL_NEEDS_CHILDREN char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SPECIALIZED_MEDICAL_CERTIFICATION char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_SUICIDAL_THREAT_ATTEMPT char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_TREATMENT_FOSTER_HOME_TRAINING char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_TUTORING char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_VISUALLY_IMPAIRED char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	FL_WEEKEND_CARE char(1) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	DT_ADDR_LAST_VERIFIED datetime NULL,
	DT_IVE_TRIBAL_AGREEMENT_EFFECTIVE datetime NULL,
	DT_ROW_BEGIN datetime NULL,
	DT_ROW_END datetime NULL,
	ID_CYCLE int NULL,
	IS_CURRENT int NULL,
	CD_MAIL_COUNTY int NULL,
	CD_PHYS_COUNTY int NULL,
	phys_zip_5 varchar(5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	CONSTRAINT PK_ID_PROVIDER_DIM PRIMARY KEY (ID_PROVIDER_DIM),
	CONSTRAINT fk_PROVIDER_DIM_ID_CALENDAR_DIM_CREATED FOREIGN KEY (ID_CALENDAR_DIM_CREATED) REFERENCES portal_redux.CALENDAR_DIM(ID_CALENDAR_DIM)
);
CREATE NONCLUSTERED INDEX idx_ID_PRVD_ORG ON portal_redux.PROVIDER_DIM (  ID_PRVD_ORG ASC  , DT_ROW_BEGIN ASC  , DT_ROW_END ASC  )  
	WITH (  PAD_INDEX = OFF ,FILLFACTOR = 100  ,SORT_IN_TEMPDB = OFF , IGNORE_DUP_KEY = OFF , STATISTICS_NORECOMPUTE = OFF , ONLINE = OFF , ALLOW_ROW_LOCKS = ON , ALLOW_PAGE_LOCKS = ON  )
	ON [PRIMARY];

-- load table data

BULK INSERT portal_redux.PROVIDER_DIM
FROM 'D:\S3\fldw-in\PROVIDER_DIM.txt'
WITH (
    firstrow = 2,
    fieldterminator = '|',
    rowterminator = '\n'
);